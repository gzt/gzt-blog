---
title: Matrixdist News
author: gzt
date: '2018-02-16'
slug: matrixdist-new
categories:
  - R
tags:
  - R
  - matrixdist
---



<p>I have just finished setting up handling for AR(1) and compound symmetry variance structures in my maximum likelihood estimation function for matrix variate normal distributions in <code>matrixdist</code>. This means I may submit it to CRAN soon (it’s currently available on <a href="http://www.github.com/gzt/matrixdist">github</a>). An example:</p>
<pre class="r"><code>library(matrixdist)
A &lt;- rmatrixnorm(100, mean=array(0,dim=c(3,4)), U = toeplitz(c(1,.8,.64)), V = rWishart(1,7,diag(4))[,,1])
MLmatrixnorm(A, row.variance=&quot;AR(1)&quot;)</code></pre>
<pre><code>$mean
           [,1]       [,2]        [,3]      [,4]
[1,] 0.07425945 -0.1277509 -0.15602140 0.5687155
[2,] 0.09761592 -0.1253225 -0.10766017 0.2535468
[3,] 0.13562486 -0.2465561 -0.06357124 0.2790545

$U
          [,1]      [,2]      [,3]
[1,] 1.0000000 0.7915968 0.6266255
[2,] 0.7915968 1.0000000 0.7915968
[3,] 0.6266255 0.7915968 1.0000000

$V
           [,1]      [,2]       [,3]       [,4]
[1,]  1.0000000 -1.214127 -0.3779589  1.2365371
[2,] -1.2141270  1.825120  0.5151700 -1.3393436
[3,] -0.3779589  0.515170  0.3699613 -0.5547584
[4,]  1.2365371 -1.339344 -0.5547584  4.9947452

$var
[1] 3.237086

$iter
[1] 17

$tol
[1] 5.677275e-08

$logLik
[1] -1808.526

$convergence
[1] TRUE

$call
MLmatrixnorm(data = A, row.variance = &quot;AR(1)&quot;)</code></pre>
<p>There is a performance hit as fitting for these require calls to <code>uniroot</code> to find the zeros of the derivatives, but it is not so bad in the cases I’ve looked at.</p>
<pre class="r"><code>library(microbenchmark)
res&lt;-microbenchmark(
  MLmatrixnorm(A),
  MLmatrixnorm(A, row.variance=&quot;AR(1)&quot;),
  MLmatrixnorm(A, row.variance=&quot;CS&quot;)
)
plot(res, log=&quot;y&quot;, names = c(&quot;None&quot;, &quot;AR(1)&quot;, &quot;CS&quot;), 
     col = c(&quot;darkred&quot;,&quot;royalblue&quot;,&quot;lightyellow&quot;),
     xlab=&quot;Variance Structure&quot;)</code></pre>
<p><img src="/post/2018-02-16-matrixdist-new_files/figure-html/benchmarking-1.png" width="672" /></p>
<p>I will need to think hard about whether I want to add anything else first, as nobody wants to deal with massive updates to functionality in fast succession.</p>
<p>Here is a possible agenda:</p>
<ul>
<li>More distributions, such as skew <span class="math inline">\(t\)</span>-distributions. I do not have much interest in matrix variate gamma distributions or beta distributions.</li>
<li>Tools for working with matrix variate distributions, such as adaptations for LDA-type activities or clustering.</li>
<li>Parameter estimation for distributions besides the normal distribution. <span class="math inline">\(t\)</span>-distributions typically require use of EM or its extensions.</li>
<li>The <span class="math inline">\(t\)</span> distribution is parameterized differently between the matrix variate and multivariate cases - namely, a factor of <span class="math inline">\(\nu\)</span>. I changed it to be consistent with the multivariate case, but I probably should not have done so.</li>
</ul>
